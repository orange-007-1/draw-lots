<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>抽签小程序</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #0c0c2e 0%, #1a1a3e 100%);
            color: #ffffff;
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }
        
        /* 背景 */
        .tech-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            overflow: hidden;
        }
        
        .grid-line {
            position: absolute;
            background: rgba(0, 247, 255, 0.05);
        }
        
        .grid-line.horizontal {
            width: 100%;
            height: 1px;
        }
        
        .grid-line.vertical {
            width: 1px;
            height: 100%;
        }
        
        .glowing-dots {
            position: absolute;
            width: 3px;
            height: 3px;
            border-radius: 50%;
            background-color: #00f7ff;
            box-shadow: 0 0 10px 2px #00f7ff;
            animation: pulse 3s infinite alternate;
        }
        
        @keyframes pulse {
            0% { opacity: 0.3; }
            100% { opacity: 0.8; }
        }
        
        /* 头部 */
        header {
            text-align: center;
            padding: 25px 20px;
            background: rgba(0, 20, 40, 0.7);
            border-bottom: 1px solid rgba(0, 247, 255, 0.3);
            box-shadow: 0 5px 20px rgba(0, 0, 50, 0.5);
            position: relative;
            overflow: hidden;
        }
        
        header::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 2px;
            background: linear-gradient(90deg, transparent, #00f7ff, transparent);
            animation: headerGlow 3s infinite;
        }
        
        @keyframes headerGlow {
            0% { left: -100%; }
            100% { left: 100%; }
        }
        
        h1 {
            font-size: 42px;
            font-weight: 700;
            background: linear-gradient(90deg, #00f7ff, #66ccff);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            text-shadow: 0 0 15px rgba(0, 247, 255, 0.5);
            letter-spacing: 2px;
            margin-bottom: 10px;
        }
        
        .subtitle {
            color: #a0d2ff;
            font-size: 16px;
            letter-spacing: 1px;
        }
        
        /* 主容器 */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 30px 20px;
        }
        
        /* 控制面板 */
        .control-panel {
            background: rgba(0, 30, 60, 0.7);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            border: 1px solid rgba(0, 150, 255, 0.3);
            box-shadow: 0 5px 20px rgba(0, 20, 60, 0.5);
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
        }
        
        .control-group {
            background: rgba(0, 40, 80, 0.5);
            padding: 20px;
            border-radius: 10px;
            border-left: 4px solid;
        }
        
        .control-group.list1 {
            border-left-color: #00f7ff;
        }
        
        .control-group.list2 {
            border-left-color: #66ccff;
        }
        
        .control-title {
            font-size: 20px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .control-title i {
            font-size: 22px;
        }
        
        .list1 .control-title {
            color: #00f7ff;
        }
        
        .list2 .control-title {
            color: #66ccff;
        }
        
        .control-item {
            margin-bottom: 15px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            color: #b0d0ff;
            font-weight: 500;
        }
        
        select {
            width: 100%;
            padding: 12px 15px;
            background: rgba(0, 60, 120, 0.6);
            border: 1px solid rgba(0, 150, 255, 0.4);
            border-radius: 8px;
            color: white;
            font-size: 16px;
            outline: none;
            transition: all 0.3s;
        }
        
        select:focus {
            border-color: #00f7ff;
            box-shadow: 0 0 10px rgba(0, 247, 255, 0.5);
        }
        
        .blue-select {
            color: #66ccff;
            font-weight: 500;
        }
        
        .tail-number-selector {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 10px;
        }
        
        .tail-number {
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(0, 100, 200, 0.3);
            border-radius: 50%;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            border: 2px solid transparent;
        }
        
        .tail-number:hover {
            background: rgba(0, 150, 255, 0.5);
            transform: translateY(-2px);
        }
        
        .tail-number.selected {
            background: #00f7ff;
            color: #003366;
            border-color: #00f7ff;
            box-shadow: 0 0 10px #00f7ff;
        }
        
        /* 按钮区域 */
        .button-panel {
            display: flex;
            justify-content: center;
            gap: 25px;
            margin: 30px 0;
        }
        
        .btn {
            padding: 15px 35px;
            border-radius: 10px;
            border: none;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 10px;
            letter-spacing: 1px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        
        .btn i {
            font-size: 20px;
        }
        
        .btn-start {
            background: linear-gradient(135deg, #0066ff, #00ccff);
            color: white;
        }
        
        .btn-start:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0, 102, 255, 0.4);
        }
        
        .btn-stop {
            background: linear-gradient(135deg, #ff3333, #ff6666);
            color: white;
        }
        
        .btn-stop:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(255, 51, 51, 0.4);
        }
        
        .btn-reset {
            background: linear-gradient(135deg, #9933ff, #cc66ff);
            color: white;
        }
        
        .btn-reset:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(153, 51, 255, 0.4);
        }
        
        /* 滚动显示区域 */
        .rolling-display {
            background: rgba(0, 20, 40, 0.8);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            border: 1px solid rgba(0, 150, 255, 0.2);
            box-shadow: 0 5px 20px rgba(0, 20, 60, 0.5);
            min-height: 220px;
            display: flex;
            flex-direction: column;
        }
        
        .rolling-title {
            font-size: 22px;
            color: #a0d2ff;
            margin-bottom: 20px;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .rolling-area {
            flex-grow: 1;
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            align-items: center;
            justify-items: center;
        }
        
        .name-slot {
            width: 100%;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(0, 40, 80, 0.6);
            border-radius: 10px;
            font-size: 20px;
            font-weight: 600;
            overflow: hidden;
            position: relative;
            border: 1px solid rgba(0, 150, 255, 0.2);
        }
        
        .name-slot.rolling {
            background: rgba(0, 60, 120, 0.7);
            border-color: rgba(0, 247, 255, 0.5);
            box-shadow: 0 0 10px rgba(0, 247, 255, 0.3);
        }
        
        .name-slot.list1 {
            color: #00f7ff;
        }
        
        .name-slot.list2 {
            color: #66ccff;
        }
        
        .name-slot.special {
            color: #ff9900;
            border-color: rgba(255, 153, 0, 0.5);
            background: rgba(255, 153, 0, 0.1);
        }
        
        /* 结果显示区域 */
        .result-display {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
            gap: 30px;
            margin-top: 20px;
        }
        
        .result-panel {
            background: rgba(0, 30, 60, 0.7);
            border-radius: 15px;
            padding: 25px;
            border: 1px solid rgba(0, 150, 255, 0.3);
            box-shadow: 0 5px 20px rgba(0, 20, 60, 0.5);
        }
        
        .result-title {
            font-size: 24px;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid;
        }
        
        .result-title.list1 {
            color: #00f7ff;
            border-bottom-color: #00f7ff;
        }
        
        .result-title.list2 {
            color: #66ccff;
            border-bottom-color: #66ccff;
        }
        
        .result-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 15px;
            max-height: 400px;
            overflow-y: auto;
            padding-right: 10px;
        }
        
        .result-list::-webkit-scrollbar {
            width: 8px;
        }
        
        .result-list::-webkit-scrollbar-track {
            background: rgba(0, 40, 80, 0.5);
            border-radius: 4px;
        }
        
        .result-list::-webkit-scrollbar-thumb {
            background: #00aaff;
            border-radius: 4px;
        }
        
        .result-item {
            padding: 12px 10px;
            text-align: center;
            background: rgba(0, 60, 120, 0.4);
            border-radius: 8px;
            font-weight: 500;
            transition: all 0.3s;
            border: 1px solid transparent;
        }
        
        .result-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 10px rgba(0, 100, 200, 0.2);
        }
        
        .result-item.list1 {
            color: #00f7ff;
        }
        
        .result-item.list2 {
            color: #66ccff;
        }
        
        .result-item.special {
            color: #ff9900;
            border-color: rgba(255, 153, 0, 0.5);
            background: rgba(255, 153, 0, 0.1);
        }
        
        .result-item.high-prob {
            border-color: rgba(0, 247, 255, 0.5);
            background: rgba(0, 247, 255, 0.1);
        }
        
        /* 状态指示器 */
        .status-indicator {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-top: 25px;
        }
        
        .status-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 16px;
            padding: 10px 20px;
            border-radius: 20px;
            background: rgba(0, 40, 80, 0.5);
        }
        
        .status-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }
        
        .status-dot.active {
            background-color: #00ff00;
            box-shadow: 0 0 10px #00ff00;
        }
        
        .status-dot.inactive {
            background-color: #666;
        }
        
        /* 分组信息显示 */
        .group-info {
            background: rgba(0, 40, 80, 0.5);
            border-radius: 10px;
            padding: 15px;
            margin-top: 20px;
            border-left: 4px solid #ff9900;
        }
        
        .group-info-title {
            color: #ff9900;
            font-weight: 600;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .group-info-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
        }
        
        .info-item {
            padding: 8px;
            background: rgba(0, 60, 120, 0.3);
            border-radius: 5px;
            font-size: 14px;
        }
        
        /* 抽取过程提示 */
        .process-info {
            background: rgba(0, 40, 80, 0.5);
            border-radius: 10px;
            padding: 15px;
            margin: 20px 0;
            border-left: 4px solid #66ccff;
        }
        
        .process-title {
            color: #66ccff;
            font-weight: 600;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .process-steps {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .process-step {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px;
            background: rgba(0, 60, 120, 0.3);
            border-radius: 5px;
        }
        
        .step-number {
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #00aaff;
            border-radius: 50%;
            font-size: 12px;
            font-weight: bold;
        }
        
        /* 响应式设计 */
        @media (max-width: 1100px) {
            .result-display {
                grid-template-columns: 1fr;
            }
        }
        
        @media (max-width: 768px) {
            .control-panel {
                grid-template-columns: 1fr;
            }
            
            .button-panel {
                flex-direction: column;
                align-items: center;
            }
            
            .btn {
                width: 100%;
                max-width: 300px;
                justify-content: center;
            }
            
            .result-display {
                grid-template-columns: 1fr;
            }
            
            h1 {
                font-size: 32px;
            }
        }
        
        /* 动画 */
        @keyframes glow {
            0% { opacity: 0.7; }
            100% { opacity: 1; }
        }
        
        .glowing {
            animation: glow 1s infinite alternate;
        }
    </style>
</head>
<body>
    <!-- 背景 -->
    <div class="tech-bg" id="techBg"></div>
    
    <!-- 头部 -->
    <header>
        <h1><i class="fas fa-random"></i> 抽签系统</h1>
        <p class="subtitle">随机抽签 | 双名单独立抽取 </p>
    </header>
    
    <div class="container">
        <!-- 控制面板 -->
        <div class="control-panel">
            <div class="control-group list1">
                <div class="control-title">
                    <i class="fas fa-list-ol"></i> 名单一设置
                </div>
                <div class="control-item">
                    <label>抽取人数：</label>
                    <select id="list1Count" class="blue-select">
                        <option value="0">请选择人数</option>
                        <!-- 选项将通过JavaScript生成 -->
                    </select>
                </div>
                <div class="control-item">
                    <label>尾号筛选（可选）：</label>
                    <div class="tail-number-selector" id="tailNumberSelector">
                        <!-- 尾号选项将通过JavaScript生成 -->
                    </div>
                </div>
                <div class="control-item">
                    <label>当前设置：</label>
                    <div id="list1Settings">未选择抽取人数，未选择尾号</div>
                </div>
            </div>
            
            <div class="control-group list2">
                <div class="control-title">
                    <i class="fas fa-list-alt"></i> 名单二设置
                </div>
                <div class="control-item">
                    <label>抽取人数：</label>
                    <select id="list2Count" class="blue-select">
                        <option value="0">请选择人数</option>
                        <!-- 选项将通过JavaScript生成 -->
                    </select>
                </div>
                <div class="control-item">
                    <label>当前设置：</label>
                    <div id="list2Settings">未选择抽取人数</div>
                </div>
            </div>
        </div>
                    
               
        <!-- 按钮区域 -->
        <div class="button-panel">
            <button class="btn btn-start" id="startBtn">
                <i class="fas fa-play"></i> 开始抽签
            </button>
            <button class="btn btn-stop" id="stopBtn" disabled>
                <i class="fas fa-stop"></i> 停止
            </button>
            <button class="btn btn-reset" id="resetBtn">
                <i class="fas fa-redo"></i> 重置
            </button>
        </div>
        
        <!-- 滚动显示区域 -->
        <div class="rolling-display">
            <div class="rolling-title">
                <i class="fas fa-spinner fa-spin"></i> 名字滚动区域
            </div>
            <div class="rolling-area" id="rollingArea">
                <!-- 名字槽位将通过JavaScript动态生成 -->
                <div class="name-slot">准备开始抽签...</div>
            </div>
        </div>
                
        <!-- 结果显示区域 -->
        <div class="result-display">
            <div class="result-panel">
                <h2 class="result-title list1">
                    <i class="fas fa-users"></i> 名单一抽中结果
                </h2>
                <div class="result-list" id="list1Result">
                    <!-- 结果将通过JavaScript动态生成 -->
                    <div class="result-item list1">等待抽签结果...</div>
                </div>
            </div>
            
            <div class="result-panel">
                <h2 class="result-title list2">
                    <i class="fas fa-users"></i> 名单二抽中结果
                </h2>
                <div class="result-list" id="list2Result">
                    <!-- 结果将通过JavaScript动态生成 -->
                    <div class="result-item list2">等待抽签结果...</div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // 数据定义
        const data = {
            list1: [
                "046863", "085777", "085406", "085760", "085381", "085535", "047749", "106620", 
                "105972", "046819", "085295", "106110", "106228", "047307", "048840", "085549", 
                "085511", "047980", "046829", "047735", "047738", "047915", "047148", "106016", 
                "047809", "085827", "047952", "106302", "085410", "085598", "106332", "049543", 
                "047304", "047941", "049465", "049424", "048055", "047389", "106172", "106502", 
                "085368", "047921", "047850", "118636", "047830", "047797", "047847", "048053", 
                "085378", "047999", "085377", "048038", "106145", "048914", "048735", "085952", 
                "106514", "047386", "049567", "085872", "085562", "085906", "106536", "047917", 
                "106382", "085978", "085389", "047509", "085405", "047994", "046821", "047949", 
                "106372", "046963", "085909", "085615", "105978", "085763", "085384", "085345", 
                "085970", "106625", "048088", "106292", "047303", "047017", "047109", "047664", 
                "085408", "106443", "085503", "085285", "047844", "048067", "047828", "105977", 
                "085395", "047815", "085883", "048089", "047392", "047387", "085376", "047862", 
                "106518", "049748", "085884", "085495", "047729", "046934", "106460", "105967", 
                "085881", "085491", "048058", "049779", "106062", "046982", "047394", "047824", 
                "106169", "106320", "047919", "106520", "085371", "047860", "085524", "085407", 
                "106168", "047525", "047734", "047995", "048042", "085387", "106323", "085965", 
                "106166", "085837", "046878", "085268", "047916", "106513", "047284", "085545", 
                "047162", "106196", "047406", "085882", "106521", "085282", "085759", "106107", 
                "085538", "085976", "085966", "047446", "049471", "047481", "106526", "047841", 
                "085640", "047842", "048045", "085840", "085539", "048077", "085528", "105970", 
                "085374", "047978", "048022", "047736", "048035", "085409", "085596", "085411", 
                "047163", "048046", "085490", "047569", "047032", "106584", "047398", "047834", 
                "085856", "048041", "047968", "047715", "085977", "106031", "106603", "047399", 
                "048066", "085576", "047956", "047894", "048028", "106226", "106173", "047936", 
                "047313", "085382", "047803", "048027", "047953", "047801", "085397", "047863", 
                "048084", "047832", "047730", "085564", "048076", "047383", "049757", "106099", 
                "106546", "105975", "047913", "049719", "047909", "085205", "047918", "048054", 
                "048083", "047783", "047737", "047957", "106682", "106011", "048073", "085623", 
                "046906", "106045", "047396", "047401", "106582", "047845", "047021", "048072", 
                "085953", "106604", "048086", "047151", "106056", "106111", "106694", "047397", 
                "048904", "047836", "106515", "047942", "106259", "085392", "085829", "085380", 
                "085899", "106037", "106003", "105971", "048871", "106167", "048934", "048169", 
                "048173", "085542", "048727", "048172", "048823", "106318", "047170", "106053", 
                "047835", "047167", "048229", "047893", "106295", "106516", "106171", "047166", 
                "085964", "106291", "085325", "085963", "047926", "047975", "047929", "048887", 
                "085544", "047868", "106505", "106602", "048158", "106501", "085496", "047432", 
                "047932", "085498", "085291", "048869", "048943", "047912", "106624", "047914", 
                "048386", "085532", "047645", "047631", "047911", "049553", "047384", "085802", 
                "048848", "046827", "047152", "106130", "085761", "048060", "048081", "047854", 
                "085527", "048064", "047958", "047961", "106322", "047031", "105958", "047169", 
                "046872", "048275", "085536", "085757", "085400", "085982", "106328", "085580", 
                "085548", "085541", "085565", "047618", "047656", "106523", "047450", "106094", 
                "105950", "105957", "106030", "048250", "048959", "085271", "085508", "106647", 
                "085823", "048741", "085930", "047112", "048212", "106035", "106466", "047164", 
                "048040", "085379", "085699", "047679", "049548", "049316", "106106", "047695", 
                "047826", "085981", "049765", "047725", "105976", "047674", "085525", "047891", 
                "047985", "047486", "106059", "106580", "048815", "048012", "049387", "047526", 
                "047145", "085885", "106155", "047849", "106019", "085451", "085531", "047663", 
                "085636", "085561", "049130", "085394", "047837", "047798", "085529", "047583", 
                "047739", "047899", "085956", "106008", "048935", "048960", "047990", "049268", 
                "047820", "047731", "049556", "048017", "085902", "048909", "047910", "082889", 
                "047385", "085547", "085521", "047732", "085611", "085900", "085897", "085974", 
                "102455", "048048", "106146", "046814", "085969", "085212"
            ],
            list2: [
                "贺倩", "温泉", "张珊", "孙溢", "何晓波", "陈文武", "王丽娟", "唐雅芝", 
                "秦莉莎", "祝文友", "刘春秀", "尹若伊", "黄阳波", "周琦", "凌育奇", "韩小莉", 
                "陈杰", "李英", "蒋溧", "幸荣明", "徐舟", "陈乾", "王厚涛", "李强（1982年9月）", 
                "串茂洁", "赵玉娟", "严冬", "孙德宣", "吕智慧", "李丽娜", "柳文英", "周梦兰", 
                "周紫涵", "伍代玲", "何云秀", "陈健为", "李强（1982年4月）", "范松鑫", "王泓翔", 
                "吴念强", "谭旭东", "于彪", "苏小力", "曾健", "张膑心", "黄小迁", "苏湘", 
                "曾沿源", "黄舒韵", "程思琪", "黄能", "夏微", "伍林", "陈修其", "王鸣剑", 
                "张洪宾", "郑朝虎", "李思静", "余浩", "周代超", "冷朝洪", "徐永家", "赵桢", 
                "黄胜", "唐永连", "严世伟", "古仁艺", "毛国安", "王生奎", "任高涌", "李建西", 
                "陈国林", "杨婷", "狄鑫宏", "周义杰", "徐小琴", "蒲久涛", "谢杰", "胡林", 
                "韩艳", "吴启彪", "郭桐生", "李明欣", "肖建", "魏霞", "孙琳", "李洪林", 
                "宋值欣", "罗广成", "甘国田", "杨紫涵", "何渊", "周华才", "王诗集", "云科", 
                "陈凤洁", "林波", "邹光兵", "章成久", "唐川杭", "单大满", "钱信任", "李丽文", 
                "聂祥", "赵雷", "陈鹏", "王强（1993年）", "周雪", "代成星", "文杰", "罗凯夫", 
                "华富阳", "邹吉义", "杨叶", "甘代伟", "黄晗虔", "吴亚磊", "郭昭金", "刘耀徽", 
                "方源", "许川", "杨舒婷", "柳永强", "于金伟", "陶宇", "邓洪", "廖永强", 
                "张进（1995年）", "曾理", "周杨彬", "朱宇均", "成强立", "江洋", "赵维程", 
                "谢磊", "宋军杰", "凌海云", "刘存鑫", "眭洪宇", "李宁", "龚均丽", "杨荣刚", 
                "袁新明", "李元其", "卢萍", "陈秋蒙", "江炆茂", "雷波", "雷莉", "龚雨琪", 
                "夏雪犁", "陶懿", "何洪霞", "王琴", "万蓝琳", "罗艳", "张学梅", "杨泽芳", 
                "易雪婷", "易芝灵", "何洁", "周凯", "袁洋", "黄姝琪", "王强（1987年）", 
                "龙蕾", "李翠莲", "代微", "邓满春", "兰翠", "何伟", "肖钰吉", "侯廷森", 
                "洪茂钦", "傅英格", "谢仲富", "邹海", "刘定林", "白永鹏", "周天星", "周瑞", 
                "黄健华", "周国强", "陈建", "钟年杰", "陈吉川", "朱涛", "莫舒帆", "郑贵兵", 
                "付宇", "张松", "张强", "李和友", "罗利平", "张兰飞", "史书吉", "袁源", 
                "方巧莹", "余俊杰", "李进", "马代雄", "丁健", "杨燚", "杨洋（1994年）", 
                "李强（1979年）", "李磊", "李俊", "马富才", "杨贵青", "蒋万石", "李涛", 
                "李秋廷", "许鑫涵", "许小康", "周杰", "叶小雨", "谢强", "李雨潇", "邓学成", 
                "陈红旭", "彭万权", "李智", "向代宇", "夏利", "卿祥伟", "练厚锋", "翁启轩", 
                "冯智", "白兴源", "马英强", "万向军", "吕智伟", "欧先乾", "刘圣", "刘强", 
                "周兴", "邱启波", "曾映塔", "罗益", "张进（1992年）", "史世秋", "李飞洋", 
                "何涛", "王傑", "李浩", "李岷声", "梁智豪", "冯昌政", "廖宏伟", "卓琳", 
                "李孟泽", "熊彬", "刘润", "余远航", "孙强", "韩剑伟", "左凯月", "肖铁文", 
                "李思蕊", "曹冰戈", "刘卓", "陈俊杰", "文科钱", "范青", "黄中", "黄小玲", 
                "余晓娟", "刘云萍", "万俊辉", "赵玻", "丁亮", "曾飞", "陈弟", "廖翰林", 
                "马双", "陈鸿圆", "刘洋", "刘宗元", "邹光才", "郑小奕", "李雪梅", "杨鸿峻", 
                "周霞", "李毅", "李培春", "李源科", "付强(1986年)", "曾章杰", "曾汶涛", 
                "林志伟", "叶汉文", "陈伟", "刘林鑫", "牟长洪", "周科吉", "黄伟", "邓燕", 
                "詹梦丽", "雷佳桥", "袁维丰", "李泽帆", "董文铭", "唐启书", "李刚", "李威（1998年）", 
                "徐钦", "陆忠文", "吴韵涵", "王永浩", "胡书铭", "张沆天", "谢佳君", "王莹莹", 
                "黄祚尧", "陈声乾", "黄建华", "饶小强", "李光伦", "凌成航", "欧鑫", "刘东", 
                "尹伟力", "王松", "杨崇禄", "陈友民", "周绍文", "刘元", "叶佳伟", "闵锐", 
                "向怀", "杨林", "付强（1997年）", "李宜航", "胡永兵", "雷洁", "杨玉林", 
                "杨冬", "张晋军", "何关培", "程旭刚", "韩明江", "范天敏", "杨富城", "王淞禾", 
                "雷芯", "杨龙彪", "邓阳", "王世金", "张智炜", "余智铨", "单琛", "詹小宜", 
                "吴振宇", "毛建杰", "陈存", "吴伟", "文艺", "唐强", "黄杰群", "黄小龙", 
                "蒲松", "刘爱秋", "王政", "丁杨", "黄河", "曾丽洁", "尹霖", "陶其宇", 
                "吴娇龙", "周秋宏", "龚林", "刘志强", "缪宇", "向杰", "毛艺朝", "宗杰", 
                "罗红升", "李文川", "杨潇", "翁玉全", "张朋", "王萝兴", "王盛果", "王杰", 
                "曾建瑀", "王万超", "吴智波", "田富权", "邓涛贵", "吴林峰", "张良川", 
                "田炀", "彭浪", "杨睿鹏", "陈先艺", "蒲纪州", "刘慧玲", "杨洋（1995年）", 
                "周瑜", "党中华", "高丰", "王富华", "李林蔚", "曾道洪", "陈良超", "谢仁凤", 
                "周代勇", "周德芹", "罗瑾", "黄旷颖", "江露", "曹开瑀", "梁永高", "易芳正", 
                "李妮娟", "蒋晓林", "黄梁超", "李小龙", "赵波", "李正柯", "丁奕", "邓国强", 
                "唐琴", "郭虹", "马思田", "曾铷洋", "刘雨浩", "文秀", "刘杰", "黄娟", 
                "胡膑", "赵鑫", "屈世勋", "吴德松", "唐洁", "吴轩", "方国银", "谢富林", 
                "覃谦", "侯叶", "郭远弈", "王勇", "江家才", "陈豆豆", "罗伟秀", "杨彬", 
                "陈家雄", "杨廷源", "寇旭东", "王川通", "曾文权", "吴锦雄", "罗治", "张琪", 
                "黄俊", "余桥", "邢绪洪", "曹帅", "曾亚玲", "田密", "袁学培", "李其龙", 
                "付英杰", "詹树铮", "王义", "胡冰堰", "周虹宇", "蒋睿", "刘鸿成", "王森健", 
                "江国强", "洪坤", "胡鸿源", "吕超", "邓海龙", "陈玉兰", "蒋永梅", "王陶", 
                "刘明燎", "陈郑", "余国盛", "毛茂娟", "毛瑞", "宋超", "冯利", "刘明义", 
                "杨超", "白世江", "胡舰", "官国勋", "郭浩", "蒋磊", "曹君", "杨腾", 
                "郑阳", "严洁", "马春喜", "杨长林", "唐淋", "伍兴奎", "杨佶霖", "毛杰", 
                "华小超", "刘志卿", "邱梦宁", "郑四民", "陈林", "黄松", "王明锋", "徐骁", 
                "黄浩", "廖科力", "李铭浩", "李华均", "李绍奇", "郑彪", "蒋伟", "黄吉情", 
                "何星辰", "侯洪志", "贾智捷", "龚玉平", "梁剑军", "曹宣", "王义林", "徐文泉", 
                "肖浙川", "徐志洪", "黄彬", "杨勇", "郝婷婷", "郑毅", "郭言", "竭永强", 
                "赵锡万", "何杰", "陈健", "赵文才", "叶茂琴", "蒋波", "罗后其", "彭小龙", 
                "邓俊", "汪春", "平毅", "蒋金伸", "蒋自强", "万向平", "朱邦文", "韦儒煌", 
                "王正", "任理蜚", "罗越鹏", "唐浩", "周极佩", "倪祥坤", "钟青文", "沈德平", 
                "罗小龙", "翁光寿", "蒋晏余", "蔡俊杰", "刘鼎", "李白嵩", "杨永功", "杨喜越", 
                "张普", "张鹏", "梁宗万", "梁刚祖", "王俊森", "张彬", "刘文章", "刘人华", 
                "陶园", "毛泽权", "谢权", "胡承义", "龙林彬", "陈值富", "林凯", "江敏", 
                "魏俊", "蔡懋", "陈南清", "刘孝坤", "刘刚", "张大彬", "熊利均", "邱和川", 
                "黄洋", "罗立竖", "王梦平", "吴俊杰", "唐钰汶", "廖茂材", "曹松涛", "雷小琴", 
                "梅禄洪", "何龙", "刘剑利", "李铁柱", "何洪德", "万小倩", "严增林", "王志文", 
                "李威（1986年）", "杨龙", "韩颜宏", "江林", "张逢琴", "邓世民", "魏刚", 
                "陈浩", "马代伟", "张冬"
            ],
            
             hGroup: [
                "106546", "047910", "106003", "047170", "085823", "085406", "105972", 
                "106620", "085295", "085511", "047738", "047148", "085827", "106536", 
                "047729", "106062", "047916", "049268"
            ]
        };
        
             const specialGroup = [
            "085544", "048848", "048727", "046827", "047167", "106318", "047994", 
            "047509", "085389", "085409", "085977", "047163", "048046", "047032", 
            "047398", "085496", "085965", "085539", "049465", "047284", "085970", 
            "106169", "047978", "047844", "048735", "085368", "085966", "047891", 
            "047845", "105971", "047166", "106516", "106259", "106694", "林凯", 
            "詹树铮", "邢绪洪", "杨崇禄", "曾飞", "沈德平", "罗越鹏", "黄能", 
            "曹冰戈", "郑彪", "牟长洪", "侯洪志", "温泉", "王诗集", "严冬", "何伟", 
            "李林蔚", "蒋波", "梁刚祖", "杨龙"
        ];
                
        const specialGroupForList1 = specialGroup.filter(item => /^\d+$/.test(item));
        const specialGroupForList2 = specialGroup.filter(item => !/^\d+$/.test(item));
        
        // 应用状态
        const state = {
            isRolling: false,
            list1Count: 0,
            list2Count: 0,
            selectedTailNumber: null,
            list1Results: [],
            list2Results: [],
            rollingInterval: null,
            rollSpeed: 50, // 初始滚动速度(ms)
            specialGroupEnabled: true,
            hGroupEnabled: true,
            processLog: [] // 记录抽取过程
        };
        
        // 初始化函数
        function init() {
            // 生成人数选择选项（5-30人）
            generateCountOptions();
            
            // 生成尾号选择器
            generateTailNumberSelector();
            
            // 创建科技感背景
            createTechBackground();
            
            // 绑定事件
            bindEvents();
            
            // 更新状态显示
            updateSettingsDisplay();
            
            console.log("抽签系统初始化完成");
            console.log(`特定人员组 - 名单一（数字）：${specialGroupForList1.length}人`);
            console.log(`特定人员组 - 名单二（文字）：${specialGroupForList2.length}人`);
        }
        
        // 生成人数选择选项（5-30人）
        function generateCountOptions() {
            const list1Select = document.getElementById('list1Count');
            const list2Select = document.getElementById('list2Count');
            
            // 清空现有选项
            list1Select.innerHTML = '<option value="0">请选择人数</option>';
            list2Select.innerHTML = '<option value="0">请选择人数</option>';
            
            // 添加5-30选项
            for (let i = 5; i <= 30; i++) {
                const option1 = document.createElement('option');
                option1.value = i;
                option1.textContent = `抽取 ${i} 人`;
                list1Select.appendChild(option1);
                
                const option2 = document.createElement('option');
                option2.value = i;
                option2.textContent = `抽取 ${i} 人`;
                list2Select.appendChild(option2);
            }
        }
        
        // 生成尾号选择器
        function generateTailNumberSelector() {
            const selector = document.getElementById('tailNumberSelector');
            selector.innerHTML = '';
            
            // 添加"不限"选项
            const unlimited = document.createElement('div');
            unlimited.className = 'tail-number selected';
            unlimited.textContent = '不限';
            unlimited.dataset.number = '';
            unlimited.addEventListener('click', function() {
                selectTailNumber('');
            });
            selector.appendChild(unlimited);
            
            // 添加0-9选项
            for (let i = 0; i <= 9; i++) {
                const numberElement = document.createElement('div');
                numberElement.className = 'tail-number';
                numberElement.textContent = i;
                numberElement.dataset.number = i;
                numberElement.addEventListener('click', function() {
                    selectTailNumber(i);
                });
                selector.appendChild(numberElement);
            }
        }
        
        // 选择尾号
        function selectTailNumber(number) {
            state.selectedTailNumber = number === '' ? null : number;
            
            // 更新UI
            const allNumbers = document.querySelectorAll('.tail-number');
            allNumbers.forEach(el => {
                el.classList.remove('selected');
                if ((number === '' && el.dataset.number === '') || 
                    (number !== '' && el.dataset.number === number.toString())) {
                    el.classList.add('selected');
                }
            });
            
            updateSettingsDisplay();
        }
        
        // 创建科技感背景
        function createTechBackground() {
            const techBg = document.getElementById('techBg');
            
            // 创建网格线
            for (let i = 0; i < 20; i++) {
                const horizontalLine = document.createElement('div');
                horizontalLine.className = 'grid-line horizontal';
                horizontalLine.style.top = `${(i * 5)}%`;
                techBg.appendChild(horizontalLine);
                
                const verticalLine = document.createElement('div');
                verticalLine.className = 'grid-line vertical';
                verticalLine.style.left = `${(i * 5)}%`;
                techBg.appendChild(verticalLine);
            }
            
            // 创建发光点
            for (let i = 0; i < 50; i++) {
                const dot = document.createElement('div');
                dot.className = 'glowing-dots';
                dot.style.left = `${Math.random() * 100}%`;
                dot.style.top = `${Math.random() * 100}%`;
                dot.style.animationDelay = `${Math.random() * 3}s`;
                dot.style.animationDuration = `${2 + Math.random() * 3}s`;
                techBg.appendChild(dot);
            }
        }
        
        // 绑定事件
        function bindEvents() {
            // 人数选择变化
            document.getElementById('list1Count').addEventListener('change', function() {
                state.list1Count = parseInt(this.value);
                updateSettingsDisplay();
            });
            
            document.getElementById('list2Count').addEventListener('change', function() {
                state.list2Count = parseInt(this.value);
                updateSettingsDisplay();
            });
            
            // 按钮事件
            document.getElementById('startBtn').addEventListener('click', startRolling);
            document.getElementById('stopBtn').addEventListener('click', stopRolling);
            document.getElementById('resetBtn').addEventListener('click', resetAll);
            
            // 初始禁用停止按钮
            document.getElementById('stopBtn').disabled = true;
        }
        
        // 更新设置显示
        function updateSettingsDisplay() {
            const list1Settings = document.getElementById('list1Settings');
            const list2Settings = document.getElementById('list2Settings');
            
            // 更新名单一设置显示
            let list1Text = `抽取人数: ${state.list1Count > 0 ? state.list1Count : '未选择'}`;
            if (state.selectedTailNumber !== null) {
                list1Text += ` | 尾号筛选: ${state.selectedTailNumber}`;
            } else {
                list1Text += ` | 尾号筛选: 不限`;
            }
            list1Settings.textContent = list1Text;
            
            // 更新名单二设置显示
            let list2Text = `抽取人数: ${state.list2Count > 0 ? state.list2Count : '未选择'}`;
            list2Settings.textContent = list2Text;
        }
        
        // 开始滚动
        function startRolling() {
            // 验证设置
            if (state.list1Count === 0 && state.list2Count === 0) {
                alert('请至少为一个名单设置抽取人数！');
                return;
            }
            
            // 验证抽取人数是否符合要求（5-30人）
            if (state.list1Count > 0 && (state.list1Count < 5 || state.list1Count > 30)) {
                alert('名单一抽取人数必须在5-30人之间！');
                return;
            }
            
            if (state.list2Count > 0 && (state.list2Count < 5 || state.list2Count > 30)) {
                alert('名单二抽取人数必须在5-30人之间！');
                return;
            }
            
            // 重置可能的上次结果
            resetResults();
            
            // 设置状态
            state.isRolling = true;
            state.processLog = [];
            document.getElementById('startBtn').disabled = true;
            document.getElementById('stopBtn').disabled = false;
            
            // 计算总抽取人数
            const totalCount = state.list1Count + state.list2Count;
            state.processLog.push(`总抽取人数: ${totalCount}人`);
            
            // 计算需要抽取的特定人员数量（总人数的1/5，向下取整）
            const specialCount = Math.floor(totalCount / 5);
            state.processLog.push(`需要抽取的特定人员数量: ${specialCount}人（总人数的1/5，向下取整）`);
            
            // 第一步：抽取特定人员组
            const specialResults = drawSpecialGroup(specialCount);
            state.processLog.push(`实际抽取的特定人员: ${specialResults.length}人`);
            
            // 分离特定人员结果到两个名单
            const specialResultsForList1 = specialResults.filter(item => /^\d+$/.test(item));
            const specialResultsForList2 = specialResults.filter(item => !/^\d+$/.test(item));
            
            state.processLog.push(`名单一特定人员: ${specialResultsForList1.length}人`);
            state.processLog.push(`名单二特定人员: ${specialResultsForList2.length}人`);
            
            // 准备原始名单副本（用于后续抽取）
            let list1Pool = [...data.list1];
            let list2Pool = [...data.list2];
            
            // 从原始名单中剔除所有特定人员（包括已抽取的和未抽取的）
            list1Pool = list1Pool.filter(item => !specialGroupForList1.includes(item));
            list2Pool = list2Pool.filter(item => !specialGroupForList2.includes(item));
            
            state.processLog.push(`剔除特定人员后名单一剩余: ${list1Pool.length}人`);
            state.processLog.push(`剔除特定人员后名单二剩余: ${list2Pool.length}人`);
            
            // 第二步：抽取普通人员
            // 计算每个名单还需要抽取的人数
            let list1Remaining = state.list1Count - specialResultsForList1.length;
            let list2Remaining = state.list2Count - specialResultsForList2.length;
            
            state.processLog.push(`名单一还需抽取: ${list1Remaining}人`);
            state.processLog.push(`名单二还需抽取: ${list2Remaining}人`);
            
            // 抽取名单一普通人员
            let list1RegularResults = [];
            if (list1Remaining > 0) {
                list1RegularResults = drawList1Regular(list1Remaining, list1Pool);
                state.processLog.push(`名单一普通人员抽取: ${list1RegularResults.length}人`);
            }
            
            // 抽取名单二普通人员
            let list2RegularResults = [];
            if (list2Remaining > 0) {
                list2RegularResults = drawList2Regular(list2Remaining, list2Pool);
                state.processLog.push(`名单二普通人员抽取: ${list2RegularResults.length}人`);
            }
            
            // 合并结果
            state.list1Results = [...specialResultsForList1, ...list1RegularResults];
            state.list2Results = [...specialResultsForList2, ...list2RegularResults];
            
            state.processLog.push(`名单一最终结果: ${state.list1Results.length}人`);
            state.processLog.push(`名单二最终结果: ${state.list2Results.length}人`);
            
            // 在控制台输出抽取过程
            console.log("=== 抽取过程日志 ===");
            state.processLog.forEach(log => console.log(log));
            
            // 准备滚动显示
            prepareRollingDisplay();
            
            // 开始滚动动画
            startRollingAnimation();
        }
        
        // 抽取特定人员组
        function drawSpecialGroup(count) {
            if (count <= 0) return [];
            
            // 确定需要从两个名单中抽取的特定人员数量
            let needFromList1 = 0;
            let needFromList2 = 0;
            
            // 如果同时抽取两个名单且总人数≥10，确保每个名单中均有特定人员
            const totalCount = state.list1Count + state.list2Count;
            const bothListsSelected = state.list1Count > 0 && state.list2Count > 0;
            
            if (bothListsSelected && totalCount >= 10) {
                // 确保每个名单至少有一个特定人员
                needFromList1 = 1;
                needFromList2 = 1;
                
                // 剩余名额随机分配
                const remaining = count - 2;
                if (remaining > 0) {
                    // 随机分配剩余名额
                    for (let i = 0; i < remaining; i++) {
                        if (Math.random() < 0.5) {
                            needFromList1++;
                        } else {
                            needFromList2++;
                        }
                    }
                }
            } else if (state.list1Count > 0 && state.list2Count === 0) {
                // 只抽取名单一
                needFromList1 = count;
            } else if (state.list2Count > 0 && state.list1Count === 0) {
                // 只抽取名单二
                needFromList2 = count;
            } else {
                // 其他情况，根据名单抽取比例分配
                const list1Ratio = state.list1Count / totalCount;
                const list2Ratio = state.list2Count / totalCount;
                
                needFromList1 = Math.round(count * list1Ratio);
                needFromList2 = count - needFromList1;
            }
            
            // 确保不超过可用的特定人员数量
            needFromList1 = Math.min(needFromList1, specialGroupForList1.length);
            needFromList2 = Math.min(needFromList2, specialGroupForList2.length);
            
            // 如果分配后总数不足，调整分配
            if (needFromList1 + needFromList2 < count) {
                const shortfall = count - (needFromList1 + needFromList2);
                // 优先补充名单一的特定人员
                if (specialGroupForList1.length > needFromList1) {
                    needFromList1 += Math.min(shortfall, specialGroupForList1.length - needFromList1);
                }
                // 如果还有不足，补充名单二
                const remainingShortfall = count - (needFromList1 + needFromList2);
                if (remainingShortfall > 0 && specialGroupForList2.length > needFromList2) {
                    needFromList2 += Math.min(remainingShortfall, specialGroupForList2.length - needFromList2);
                }
            }
            
            // 抽取名单一特定人员
            const list1SpecialResults = drawFromArray(specialGroupForList1, needFromList1);
            
            // 抽取名单二特定人员
            const list2SpecialResults = drawFromArray(specialGroupForList2, needFromList2);
            
            // 合并结果
            return [...list1SpecialResults, ...list2SpecialResults];
        }
        
        // 从数组中随机抽取指定数量的元素（不重复）
        function drawFromArray(array, count) {
            if (count <= 0) return [];
            
            // 创建数组副本
            const pool = [...array];
            const results = [];
            
            // 如果需求数量超过数组长度，则只抽取数组长度
            const actualCount = Math.min(count, pool.length);
            
            // 随机抽取
            for (let i = 0; i < actualCount; i++) {
                const randomIndex = Math.floor(Math.random() * pool.length);
                results.push(pool[randomIndex]);
                pool.splice(randomIndex, 1); // 避免重复
            }
            
            return results;
        }
        
        // 抽取名单一普通人员
        function drawList1Regular(count, pool) {
            if (count <= 0) return [];
            
            // 应用尾号筛选
            let availableList = [...pool];
            if (state.selectedTailNumber !== null) {
                availableList = availableList.filter(item => 
                    item.endsWith(state.selectedTailNumber.toString())
                );
            }
            
            let weightedList = [];
            if (state.hGroupEnabled) {
                 const hItems = availableList.filter(item => 
                    data.hGroup.includes(item)
                );
                const otherItems = availableList.filter(item => 
                    !data.hGroup.includes(item)
                );
                          
                weightedList = [...otherItems];
                hItems.forEach(item => {
                    weightedList.push(item);
                    weightedList.push(item);
                    weightedList.push(item);
                });
            } else {
                weightedList = [...availableList];
            }
            
            // 随机抽取
            return drawFromArray(weightedList, count);
        }
        
        // 抽取名单二普通人员
        function drawList2Regular(count, pool) {
            if (count <= 0) return [];
            
            // 随机抽取
            return drawFromArray(pool, count);
        }
        
        // 准备滚动显示
        function prepareRollingDisplay() {
            const rollingArea = document.getElementById('rollingArea');
            rollingArea.innerHTML = '';
            
            // 确定需要显示的名字槽位数量
            const totalSlots = state.list1Results.length + state.list2Results.length;
            
            // 如果没有结果，显示提示
            if (totalSlots === 0) {
                const slot = document.createElement('div');
                slot.className = 'name-slot';
                slot.textContent = '无抽签结果';
                rollingArea.appendChild(slot);
                return;
            }
            
            // 创建名字槽位
            for (let i = 0; i < totalSlots; i++) {
                const slot = document.createElement('div');
                slot.className = 'name-slot rolling';
                slot.id = `slot-${i}`;
                
                // 确定这个槽位属于哪个名单
                if (i < state.list1Results.length) {
                    slot.classList.add('list1');
                } else {
                    slot.classList.add('list2');
                }
                
                // 检查是否是特定人员
                const resultIndex = i < state.list1Results.length ? i : i - state.list1Results.length;
                const resultList = i < state.list1Results.length ? state.list1Results : state.list2Results;
                const resultItem = resultList[resultIndex];
                
                if (specialGroup.includes(resultItem)) {
                    slot.classList.add('special');
                }
                
                rollingArea.appendChild(slot);
            }
        }
        
        // 开始滚动动画
        function startRollingAnimation() {
            state.rollSpeed = 50; // 初始速度
            clearInterval(state.rollingInterval);
            
            state.rollingInterval = setInterval(() => {
                updateRollingDisplay();
            }, state.rollSpeed);
        }
        
        // 更新滚动显示
        function updateRollingDisplay() {
            const totalSlots = state.list1Results.length + state.list2Results.length;
            
            for (let i = 0; i < totalSlots; i++) {
                const slot = document.getElementById(`slot-${i}`);
                if (!slot) continue;
                
                // 确定这个槽位属于哪个名单
                const isList1 = i < state.list1Results.length;
                const resultList = isList1 ? data.list1 : data.list2;
                const finalResult = isList1 ? 
                    state.list1Results[i] : 
                    state.list2Results[i - state.list1Results.length];
                
                // 生成随机名字
                let randomName;
                if (isList1 && state.selectedTailNumber !== null) {
                    // 对于名单一，如果设置了尾号，只从符合尾号的名字中随机选择
                    const filteredList = data.list1.filter(item => 
                        item.endsWith(state.selectedTailNumber.toString())
                    );
                    const randomIndex = Math.floor(Math.random() * filteredList.length);
                    randomName = filteredList[randomIndex];
                } else {
                    // 普通随机选择
                    const randomIndex = Math.floor(Math.random() * resultList.length);
                    randomName = resultList[randomIndex];
                }
                
                slot.textContent = randomName;
            }
        }
        
        // 停止滚动
        function stopRolling() {
            if (!state.isRolling) return;
            
            state.isRolling = false;
            document.getElementById('startBtn').disabled = false;
            document.getElementById('stopBtn').disabled = true;
            
            // 逐步减慢滚动速度
            const slowDown = () => {
                state.rollSpeed += 10;
                
                if (state.rollSpeed >= 200) {
                    // 完全停止
                    clearInterval(state.rollingInterval);
                    showFinalResults();
                    return;
                }
                
                clearInterval(state.rollingInterval);
                state.rollingInterval = setInterval(() => {
                    updateRollingDisplay();
                }, state.rollSpeed);
                
                // 继续减速
                setTimeout(slowDown, 100);
            };
            
            slowDown();
        }
        
        // 显示最终结果
        function showFinalResults() {
            const totalSlots = state.list1Results.length + state.list2Results.length;
            
            // 显示最终名字
            for (let i = 0; i < totalSlots; i++) {
                const slot = document.getElementById(`slot-${i}`);
                if (!slot) continue;
                
                // 移除滚动类
                slot.classList.remove('rolling');
                
                // 显示最终结果
                const isList1 = i < state.list1Results.length;
                const finalResult = isList1 ? 
                    state.list1Results[i] : 
                    state.list2Results[i - state.list1Results.length];
                
                slot.textContent = finalResult;
            }
            
            // 更新结果显示区域
            updateResultDisplay();
        }
        
        // 更新结果显示区域
        function updateResultDisplay() {
           // 更新名单一结果
            const list1ResultArea = document.getElementById('list1Result');
            list1ResultArea.innerHTML = '';
            
            if (state.list1Results.length === 0) {
                const emptyItem = document.createElement('div');
                emptyItem.className = 'result-item list1';
                emptyItem.textContent = '未抽取名单一';
                list1ResultArea.appendChild(emptyItem);
            } else {
                // 统计特定人员数量
                let specialCount = 0;
                                
                state.list1Results.forEach((item, index) => {
                    const resultItem = document.createElement('div');
                    resultItem.className = 'result-item list1';
                    
                    // 检查是否是特定人员
                    if (specialGroup.includes(item)) {
                        resultItem.classList.add('special');
                        resultItem.title = '特定人员组成员';
                        specialCount++;
                    }
                                       
                    resultItem.textContent = `${index + 1}. ${item}`;
                    list1ResultArea.appendChild(resultItem);
                });
              }
            
            // 更新名单二结果
            const list2ResultArea = document.getElementById('list2Result');
            list2ResultArea.innerHTML = '';
            
            if (state.list2Results.length === 0) {
                const emptyItem = document.createElement('div');
                emptyItem.className = 'result-item list2';
                emptyItem.textContent = '未抽取名单二';
                list2ResultArea.appendChild(emptyItem);
            } else {
                // 统计特定人员数量
                let specialCount = 0;
                
                state.list2Results.forEach((item, index) => {
                    const resultItem = document.createElement('div');
                    resultItem.className = 'result-item list2';
                    
                    // 检查是否是特定人员
                    if (specialGroup.includes(item)) {
                        resultItem.classList.add('special');
                        resultItem.title = '特定人员组成员';
                        specialCount++;
                    }
                    
                    resultItem.textContent = `${index + 1}. ${item}`;
                    list2ResultArea.appendChild(resultItem);
                });
               
               
            }
        }
        
        // 重置结果
        function resetResults() {
            state.list1Results = [];
            state.list2Results = [];
            
            const rollingArea = document.getElementById('rollingArea');
            rollingArea.innerHTML = '<div class="name-slot">准备开始抽签...</div>';
            
            const list1ResultArea = document.getElementById('list1Result');
            list1ResultArea.innerHTML = '<div class="result-item list1">等待抽签结果...</div>';
            
            const list2ResultArea = document.getElementById('list2Result');
            list2ResultArea.innerHTML = '<div class="result-item list2">等待抽签结果...</div>';
        }
        
        // 重置所有
        function resetAll() {
            // 停止滚动
            if (state.isRolling) {
                clearInterval(state.rollingInterval);
                state.isRolling = false;
            }
            
            // 重置状态
            state.list1Count = 0;
            state.list2Count = 0;
            state.selectedTailNumber = null;
            state.list1Results = [];
            state.list2Results = [];
            state.processLog = [];
            
            // 重置UI
            document.getElementById('list1Count').value = 0;
            document.getElementById('list2Count').value = 0;
            document.getElementById('startBtn').disabled = false;
            document.getElementById('stopBtn').disabled = true;
            
            // 重置尾号选择器
            const allNumbers = document.querySelectorAll('.tail-number');
            allNumbers.forEach(el => {
                el.classList.remove('selected');
                if (el.dataset.number === '') {
                    el.classList.add('selected');
                }
            });
            
            // 重置结果显示
            resetResults();
            
            // 更新设置显示
            updateSettingsDisplay();
            
            console.log("系统已重置");
        }
        
        // 页面加载完成后初始化
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>

</html>
